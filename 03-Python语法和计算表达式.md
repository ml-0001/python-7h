# 语法与计算表达式

上节课已经将`Python 编程环境`准备完成, 还介绍了一个Python代码的主要结构, 这节课具体展开Python代码的语法和其中的表达式部分 .

## 交互式执行 Python 解释器
由于这节课会有大量短小代码举例, 暂时不用编写长篇代码, Python的解释器程序提供了一个可以一边输入代码,一边执行的环境, 这种一边输入代码,一边执行的过程,
也叫做`交互式执行` , 特别适合验证短小代码语法正确性 。

在安装了Python 3.7.1 后, 您可以在命令行窗口中输入Python 然后就可以启动Python 解释器 。 

也可以点击Windows开始菜单 , 在开始菜单中 , 输入Python 搜索, 然后选择Python 3.7.1 程序直接打开 。

![](assets/03/img/start_python3.png "从开始菜单启动")

![](assets/03/img/py3_shell.png "启动Python解释器后")

在Python解释器中, 就可以直接输入`表达式` , 如果是一个完整的`表达式` 回车后就会输出表达式的结果`值` 。

## 基础语法

Python 代码语法其实很简单, 就像说话表达一样 , 一段话总是由句子构成 。 从最上层看, Python代码都是语句构成的 。
```
程序代码
    语句[;语句]
    语句[<换行>语句]
```
Python的`程序代码` 由`语句`序列构成 。
如果有多个语句, 那么语句之间可以通过`;`或者`换行`分割 。
例如:
```python
1+2;(3+5)*7 #两个计算表达式,通过`;` 连接
2/4
1+5+7+7*2+1
```
以上代码就有4个语句, 第一行两个算数表达式是两个语句, 通过`;`组成 , 第一行,第二行和第三行的语句通过`换行`分割 。

当程序运行时 , 解释器按照输入顺序, `从左往右,从上往下`, 顺序执行每条语句 , 这种默认顺序代码执行顺序叫做`顺序执行结构`。 

在你的解释器程序中 , 你可以尝试输入以上代码然后按回车键观察 , 会发现以上每个算数表达式结束后, 解释器都会输出`结果值`, 这是因为如果一条语句是一个`表达式`, 那么每个表达式都有一个结果`值`, 解释器会做求值计算, 为了方便人类观察， 会把求值结果输出到屏幕 。

那么在Python中, 具体有哪些语句呢 ?

### 语句
```
语句
    求值表达式
        原子表达式
            标识符: words_to_say (变量)
            数值: 3.14159265358 (常量)
            字符串: "How do you do ?" (常量)
        复合表达式
            数学运算表达式
                字符串计算表达式
                数值计算表达式
                逻辑计算表达式
            函数运算表达式
                函数调用: print(3.1415926)
                匿名函数表达式(lambda): (lambda x: 3.14159265*x*x )(2.5)
                对象构造表达式: CObj(...)
                列表解析表达式: [v(x) for x in itr if b(x)]
    -------------------------------------------------------------------
    条件语句
    循环语句    
    赋值语句 
    模块导入语句
    函数定义语句
    类定义语句  
    其他语句

```
这里大致列举了常见的按照功能分类的语句, 可以分为8类:
* `求值表达式`
* `条件语句`
* `循环语句`
* `赋值表语句`
* `模块导入语句`
* `函数定义语句`
* `类定义语句`
* `其他语句`

#### 求值表达式
求值表达式是指, 这个表达式的主要目标是求值 , 通常用来计算或者调用函数执行指定功能 。

求值表达式 , 可以分为:
* `原子表达式`
* `复合表达式` 。

`原子表达式`是指这个表达式是一个不可分割的基本值 , 主要有三种:

* `标识符变量` 
* `数值常量`
* `字符串常量`

而`复合表达式` 是指由各种`表达式`通过`运算符`构成的表达式 。 这个表达式的定义使用了表达式自身的概念, 这种定义叫做`递归定义`的概念, 有点像数学归纳法哈 。
就是说表达式可以是一常量或者变量这样的表达式基本单元构成, 还可以是表达式之间通过运算符(如加减乘除求幂求对数等运算) 连接构成 。

##### 原子表达式 

`常量` 是指在代码中已经明确了(字面)值, 又不需要运算的代码表达 。 比如 `5` , `3.0245`, `"R U OK?"` , 通俗来讲, 这些代码中`写死`的值就叫做(字面)常量 。

> 还记得被遗忘的CE么 ? 你给CE 100元, 跟CE说:"去买`2.5`Kg大米, 再买`1` 个西瓜, `剩余的钱`买糖, 跟老板复述说:`只要麒麟瓜,6斤以上`..." ， 这里的2.5, 1, "只要麒麟瓜,6斤以上" 是你在指令中直接表明的量就是常量, 对于数字来说, 叫做`数值常量`, 对于文字来说, 叫做`字符串常量` .

如下代码:
```python
print("Hi")
```
这个代码中, `"Hi"` 就是常量 。


`变量` 是指在代码中以`标识符名字`代替具体的值, 而值可以随着代码被改变, 只有再运算时由计算机求值才能计算得知的那些表达量 。比如下代码:

```python
words = "Hi!"
print(words)

x=2.0
y=x*x
x=3.0
y=x*x*x
print(y)
```

代码中的`words` 就是一个变量 , words在作为实参传给print函数时,print要输出具体的内容(当然不是显示成"words"), 所以需要先对words求值, 只有求值后print才能输出words真正内容"Hi!"。
代码中的`x`,`y`也是变量, `x`,`y` 都只是个具体值的`名字` , 而且他们的值在运行过程中会发生改变 。

> CE 买了大米, 西瓜, 直到他买完付款, 才知道`剩余的钱` 是 43 元, 那么这时候才知道`剩余的钱`其实是指代`100元减去购买大米和西瓜后找回的钱` , 这就是个变量 , 如果当天的西瓜和大米价格有变化, 这个`剩余的钱`也会随着变化 , 话说回来, 其实`西瓜和大米的价格`也是个变量, 会随着市场行情变化  。

关于变量更具体的解释 , 我们在第四课再展开。

##### 复合表达式

复合表达式是将表达式组合出复杂表达式的手段 , 就像数学中, 我们本来只有实数(常量), 然后引入了代数字母 (a,b,c:变量) , 将实数和实数, 实数和代数字母通过各种加减乘除等运算组合在一起构成了代数表达式,
比如 1.52 * a + 2.56 * b 。 按照运算形式不同, 我们可以将复合表达式分为:
* `数学符号运算表达式`
* `函数运算表达式`

数学运算符号表达式是指那些用 `运算符` 连接起来的表达式， 例如: `5+4` ， `5 * x * x` , `the_cat_is_smelly or (5 -3) > 0 and (2.0 * x * x) < 2.452` 。

求值运算符表达式, 一会儿我们会详细介绍 。

函数运算表达式是指, 使用`函数类`参与运算的表达式例如: `math.sin(2.6423)` , `math.sqrt(5.21)`, `print("HelloKity")` 。

函数和类等的内容我们在第五课会详细解释 。

#### 其他非表达式语句

以下语句自身有特定的结构(语法) , 这里只做简单解释介绍, 后续会详细讲解 。

```
赋值语句
    标识符 = 表达式

模块导入语句
    import <模块名>： import sys

条件语句    
    if <逻辑表达式> :
    [空白缩进]程序代码

    if <逻辑表达式>:
    [空白缩进]程序代码
    else:
    [空白缩进]程序代码


循环语句
    while <逻辑表达式>:
    [空白缩进]程序代码
    
    for itr in <可迭代值的表达式>:
    [空白缩进]程序代码

类定义语句
    class ClassName(object):
        <Class Body>
函数定义语句
    def Function Name(Arguments List):
        <Function Body>

```
#### 赋值语句

`变量` 是执行代码指令时 , 给那些表达式的结果值一个名字, 后面的表达式在使用时就方便了很多 。 `变量名` = `表达式` ， 这就是一条赋值语句 。
执行后 , 这个变量就保存了`表达式的值` (或者引用,后续再详细讨论)。

#### 模块导入语句

模块导入语句是指 , 当我们的代码引用到其他的代码文件时, 需要导入`第三方代码`时的语法 , 在第八课我们再讲 。

#### 条件语句

条件语句是指 , 代码默认只能顺序执行，但是我的代码需要处理动态情况 , 比如 `变量` x 取值在某个区间`[1,2)`时,我输出"NiHao", 否则我输出"Hello", 就是代码执行要根据条件选择选择执行 。
那么就得用条件语句来表达 ，在下节课我们详细展开 。

#### 循环语句

循环语句是指 , 代码默认只能顺序执行，但是我的代码需要处理动态情况 , 比如我要将 "NiHao" 这段文字输出n次, 而n是一个`变量`(根据情况,可能是1,也可能是1亿), 就是代码可以支持某种环境循环执行 。
那么就得用循环语句来表达 ，在下节课我们详细展开 。

#### 函数定义语句,类定义语句

函数定义是指将完成一定功能的代码封装成一个接口(名字),  然后就可以被其他代码直接用名字使用 。 例如我定义一个计算球体体积的函数 , 那你计算球体体积时, 只需要把半径参数传给我, 我就给你计算好了 。
类定义也是类似函数, 就算没有类, 也不影响你的代码描述 , 不过有类之后 , 在语言表达方式上, 比较适合人类的一些思维习惯 。
函数和类在第五课我们详细解释 。

#### 其他语句
还有其他如 with 语句, 一些语法糖(以上语法的变种写法,只是为了方便)等,我们在后续遇到了再解释把 , 这些在入门阶段不重要 。


### 语法归纳

根据以上的介绍, 可以用以下图概括Python 的主要语法树结构 。

![](assets/03/img/syntax.png "Python语法归纳")


### 缩进法则

Python 的代码块中，主要有条件语句和循环语句,以及类,函数定义体涉及到嵌入`程序代码` , 程序代码呢, 又是一个完整的程序结构块, 所以需要一种形式标识出来, 其他某些语言使用`{ ... }` 这种形式来标记, 而Python中使用的是缩进对齐方式来标记, 这样可以保证代码的优雅美观 .

缩进空白字符没有规定要缩进多少个, 规则是代码块的`缩进应当对齐`, 缩进`空白字符至少1个`, 通常每级代码块我们使用`4个空格字符`缩进 .

如下代码都是合法的:
```python
if cond_var:
 print("hello1 code block with 1 white characters")
 print("hello2 code block with 1 white characters")

 if cond_var:
   print("hello1 code block with 2 white characters")
   print("hello2 code block with 2 white characters")

 if cond_var:
     print("hello1 code block with 4 white characters")
     print("hello2 code block with 4 white characters")


```

这里演示一个语法错误的代码段:

```python
if cond_var:
 print("hello code block with 1 white characters")
   print("hello code block with 2 white characters (错误代码,应当与代码块上一行对齐,1个空格)")
     print("hello code block with 4 white characters (错误代码,应当与代码块第一行对齐,1个空格)")

```

### 代码规范

Python本身语法比较简单,并没有规定太多. 但是写代码就像写文章, 如果遵循一定大家默认守则, 可以让别人阅读的更容易, 自己写完后再阅读也能快速回忆起当时编写的思路。

其中[PEP8,Python社区的语言规范建议/提案] 规范建议了Python代码中的元素,如变量,函数,对齐,命名的规范, 这样比较有Python的范儿. https://pypi.org/project/pep8/

Google 公司(Python语言的爸爸就在Google工作)也推出了自己的Python代码规范建议:https://google.github.io/styleguide/pyguide.html


## 求值表达式

由于表达式求值在代码计算中非常重要，是语言表达的基础, 这里会详细解释下 。

### 再论表达式的递归定义

### 数据类型

### 运算表达式

#### 运算符优先级

#### 数值表达式

#### 逻辑表达式

#### 文字表达式



## 总结
本课程主要介绍了下Python的语法概览, 我们学习一门语言一个主要任务是学习语言的语法, 有了语法后就可以按照语法来表达程序的思想, 本课还着重介绍了其中的基础运算表达式, 数据类型, 和表达式求值概念, 还提及了后续会详细介绍的字符串,函数,变量概念. 后续的5节课其实都是在介绍本课程提到Python的语法树概念, 下一课我们介绍变量和控制结构概念 。

本课主要需要掌握以下概念:
* 交互式执行
* Python代码语法结构
* 语句
* 顺序代码执行
* 缩进法则
* 数据类型概念
* 常量
* 复合表达式
* 运算符优先级


## 小测验
1. 编写代码求3.25m半径的圆的面积 (圆面积公式是 pi*r*r)
2. 这个表达式 `"Hi,Kity" + 3.25` 是否合法 ? 想想为什么呢 ?
3. 数学表达式 `2.24*521+22412*2.4/(98.4+256.821*6.11)` 的运算先后顺序是怎样的 ?
4. 怎样用Python表达 `猫喜欢吃胡萝卜并且兔子爱吃鱼或者冬天不冷` ?


